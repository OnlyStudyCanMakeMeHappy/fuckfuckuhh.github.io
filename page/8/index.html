<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/icon-money.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/icon-money.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Ubuntu:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.0/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css">

<script class="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Mist","version":"8.0.1","exturl":false,"sidebar":{"position":"right","display":"hide","padding":18,"offset":6},"copycode":true,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}};
  </script>

  <meta name="description" content="wdnmd">
<meta property="og:type" content="website">
<meta property="og:title" content="Mr.fuck">
<meta property="og:url" content="http://example.com/page/8/index.html">
<meta property="og:site_name" content="Mr.fuck">
<meta property="og:description" content="wdnmd">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="ggl">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://example.com/page/8/">


<script class="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>Mr.fuck</title>
  






  <noscript>
  <style>
  body { margin-top: 2rem; }

  .use-motion .menu-item,
  .use-motion .sidebar,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header {
    visibility: visible;
  }

  .use-motion .header,
  .use-motion .site-brand-container .toggle,
  .use-motion .footer { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle,
  .use-motion .custom-logo-image {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line {
    transform: scaleX(1);
  }

  .search-pop-overlay, .sidebar-nav { display: none; }
  .sidebar-panel { display: block; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Mr.fuck</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
  </ul>
</nav>




</div>
        
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <section class="post-toc-wrap sidebar-panel">
      </section>
      <!--/noindex-->

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="ggl"
      src="/images/Kobe.jpg">
  <p class="site-author-name" itemprop="name">ggl</p>
  <div class="site-description" itemprop="description">wdnmd</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">20</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">9</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">19</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="sidebar-button site-overview-item animated"><i class="fa fa-comment"></i>
    Chat
  </a>
  </div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/fuckfuckuhh" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;fuckfuckuhh" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:chenxiaoxiang0102@gmail.com" title="E-Mail → mailto:chenxiaoxiang0102@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



      </section>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner index posts-expand">
      

      
    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/11/13/Pandas/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/Kobe.jpg">
      <meta itemprop="name" content="ggl">
      <meta itemprop="description" content="wdnmd">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mr.fuck">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/11/13/Pandas/" class="post-title-link" itemprop="url">pandas</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-11-13 13:54:22" itemprop="dateCreated datePublished" datetime="2020-11-13T13:54:22+08:00">2020-11-13</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2020-11-15 12:37:23" itemprop="dateModified" datetime="2020-11-15T12:37:23+08:00">2020-11-15</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/data-analysis/" itemprop="url" rel="index"><span itemprop="name">data analysis</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="Series"><a href="#Series" class="headerlink" title="Series"></a>Series</h2><p>python&lt;3.6并且Pandas版本&lt;0.23，传入字典构造Series时，默认为排好序的字典键。可以通过传入想要的顺序让Series索引顺序符合预期。</p>
<p><code>s = pd.Series(data,index=index)</code></p>
<p>data可以是：</p>
<ul>
<li>字典</li>
<li>ndarray数组</li>
<li>标量</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; pd.Series(5.,index&#x3D;[1,2,3,4,5])</span><br><span class="line">1    5.0</span><br><span class="line">2    5.0</span><br><span class="line">3    5.0</span><br><span class="line">4    5.0</span><br><span class="line">5    5.0</span><br></pre></td></tr></table></figure>
<p>1、ndarray-like</p>
<p>可以像ndarry一样索引切片，布尔索引。</p>
<p>同时拥有一个dtype属性，通常为Numpy dtype。</p>
<p>扩展dtype类型：Categorical data和Nullable integer data type。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>s = pd.Series(np.random.randn(<span class="number">5</span>))</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s[s&gt;s.median()]</span><br><span class="line"><span class="number">1</span>    <span class="number">0.891051</span></span><br><span class="line"><span class="number">2</span>    <span class="number">1.146825</span></span><br><span class="line">dtype: float64</span><br></pre></td></tr></table></figure>
<p>查看Series的实际数组使用Series.array</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; s.array</span><br><span class="line">&lt;PandasArray&gt;</span><br><span class="line">[-1.2962129040498895,  0.8910505879435743,  1.1468249768170848,</span><br><span class="line"> -0.6983272625814929,  0.3864291674151894]</span><br><span class="line">Length: 5, dtype: float64</span><br></pre></td></tr></table></figure>
<p>想获得实际的ndarray使用Series.to_numpy()</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>s.to_numpy()</span><br><span class="line">array([<span class="number">-1.2962129</span> ,  <span class="number">0.89105059</span>,  <span class="number">1.14682498</span>, <span class="number">-0.69832726</span>,  <span class="number">0.38642917</span>])</span><br></pre></td></tr></table></figure>
<p>2、dict-like</p>
<p>可以像字典一样通过键值获得value</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>s = pd.Series(np.random.randn(<span class="number">5</span>),index=[<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;d&#x27;</span>,<span class="string">&#x27;e&#x27;</span>])</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s</span><br><span class="line">a    <span class="number">0.252874</span></span><br><span class="line">b    <span class="number">0.446320</span></span><br><span class="line">c   <span class="number">-0.767644</span></span><br><span class="line">d   <span class="number">-0.043477</span></span><br><span class="line">e    <span class="number">1.320808</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s[<span class="string">&#x27;a&#x27;</span>]</span><br><span class="line"><span class="number">0.2528741453587309</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s.get(<span class="string">&#x27;e&#x27;</span>)</span><br><span class="line"><span class="number">1.3208077587455038</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s.get(<span class="string">&#x27;f&#x27;</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s.get(<span class="string">&#x27;f&#x27;</span>,<span class="string">&#x27;None&#x27;</span>)</span><br><span class="line"><span class="string">&#x27;None&#x27;</span></span><br></pre></td></tr></table></figure>
<p>3、缺失值检查</p>
<p>isnull和notnull</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>s = pd.Series([<span class="number">1</span>,<span class="number">2</span>,np.nan])</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s</span><br><span class="line"><span class="number">0</span>    <span class="number">1.0</span></span><br><span class="line"><span class="number">1</span>    <span class="number">2.0</span></span><br><span class="line"><span class="number">2</span>    NaN</span><br><span class="line">dtype: float64</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s.isnull()</span><br><span class="line"><span class="number">0</span>    <span class="literal">False</span></span><br><span class="line"><span class="number">1</span>    <span class="literal">False</span></span><br><span class="line"><span class="number">2</span>     <span class="literal">True</span></span><br><span class="line">dtype: bool</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s.notnull</span><br><span class="line">&lt;bound method Series.notnull of <span class="number">0</span>    <span class="number">1.0</span></span><br><span class="line"><span class="number">1</span>    <span class="number">2.0</span></span><br><span class="line"><span class="number">2</span>    NaN</span><br><span class="line">dtype: float64&gt;</span><br></pre></td></tr></table></figure>
<p>4、name属性</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>s = pd.Series(&#123;<span class="string">&#x27;Ohio&#x27;</span>:<span class="number">35000</span>,<span class="string">&#x27;Texas&#x27;</span>:<span class="number">71000</span>,<span class="string">&#x27;Utha&#x27;</span>:<span class="number">5000</span>&#125;)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s.name = <span class="string">&#x27;state&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s.name = <span class="string">&#x27;population&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s.index.name = <span class="string">&#x27;state&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s</span><br><span class="line">state</span><br><span class="line">Ohio     <span class="number">35000</span></span><br><span class="line">Texas    <span class="number">71000</span></span><br><span class="line">Utha      <span class="number">5000</span></span><br><span class="line">Name: population, dtype: int64</span><br></pre></td></tr></table></figure>
<h2 id="DataFrame"><a href="#DataFrame" class="headerlink" title="DataFrame"></a>DataFrame</h2><h3 id="基本操作"><a href="#基本操作" class="headerlink" title="基本操作"></a>基本操作</h3><p>1、From dict of Series or dicts</p>
<p>结果索引会取每个Series的并集。</p>
<p>如果是嵌套字典，字典的键会变成列，字典内的键将作为行索引</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>d = &#123;<span class="string">&#x27;one&#x27;</span>:pd.Series([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>],index=[<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>]),</span><br><span class="line"><span class="meta">... </span>    <span class="string">&#x27;two&#x27;</span>:pd.Series([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>],index=[<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;d&#x27;</span>])&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df = pd.DataFrame(d)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df</span><br><span class="line">   one  two</span><br><span class="line">a  <span class="number">1.0</span>    <span class="number">1</span></span><br><span class="line">b  <span class="number">2.0</span>    <span class="number">2</span></span><br><span class="line">c  <span class="number">3.0</span>    <span class="number">3</span></span><br><span class="line">d  NaN    <span class="number">4</span></span><br></pre></td></tr></table></figure>
<p>2、From dict of ndarrays / lists</p>
<p>数组的长度必须一样长</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>d = &#123;<span class="string">&#x27;one&#x27;</span>:[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>],<span class="string">&#x27;two&#x27;</span>:[<span class="number">4</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">1</span>]&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>pd.DataFrame(d)</span><br><span class="line">   one  two</span><br><span class="line"><span class="number">0</span>    <span class="number">1</span>    <span class="number">4</span></span><br><span class="line"><span class="number">1</span>    <span class="number">2</span>    <span class="number">3</span></span><br><span class="line"><span class="number">2</span>    <span class="number">3</span>    <span class="number">2</span></span><br><span class="line"><span class="number">3</span>    <span class="number">4</span>    <span class="number">1</span></span><br></pre></td></tr></table></figure>
<p>3、From a list of dicts</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>data = [&#123;<span class="string">&#x27;a&#x27;</span>: <span class="number">1</span>, <span class="string">&#x27;b&#x27;</span>: <span class="number">2</span>&#125;, &#123;<span class="string">&#x27;a&#x27;</span>: <span class="number">5</span>, <span class="string">&#x27;b&#x27;</span>: <span class="number">10</span>, <span class="string">&#x27;c&#x27;</span>: <span class="number">20</span>&#125;]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>pd.DataFrame(data)</span><br><span class="line">   a   b     c</span><br><span class="line"><span class="number">0</span>  <span class="number">1</span>   <span class="number">2</span>   NaN</span><br><span class="line"><span class="number">1</span>  <span class="number">5</span>  <span class="number">10</span>  <span class="number">20.0</span></span><br></pre></td></tr></table></figure>
<p>4、插入新列</p>
<p><code>insert(loc, column, value, allow_duplicates=False)</code></p>
<p>直接赋值插入</p>
<p>del删除列</p>
<p>对DataFrame的操作都是视图上进行</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>df</span><br><span class="line">   one  two</span><br><span class="line">a    <span class="number">1</span>    <span class="number">3</span></span><br><span class="line">b    <span class="number">2</span>    <span class="number">4</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df.insert(<span class="number">1</span>,<span class="string">&#x27;zero&#x27;</span>,df[<span class="string">&#x27;one&#x27;</span>]<span class="number">-1</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df</span><br><span class="line">   one  zero  two</span><br><span class="line">a    <span class="number">1</span>     <span class="number">0</span>    <span class="number">3</span></span><br><span class="line">b    <span class="number">2</span>     <span class="number">1</span>    <span class="number">4</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df[<span class="string">&#x27;four&#x27;</span>] = np.array([<span class="number">4</span>,<span class="number">4</span>])</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df</span><br><span class="line">   one  zero  two  four</span><br><span class="line">a    <span class="number">1</span>     <span class="number">0</span>    <span class="number">3</span>     <span class="number">4</span></span><br><span class="line">b    <span class="number">2</span>     <span class="number">1</span>    <span class="number">4</span>     <span class="number">4</span></span><br></pre></td></tr></table></figure>
<p>5、name属性和values属性</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>df.index.name = <span class="string">&#x27;row&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df.columns.name = <span class="string">&#x27;col&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df.values</span><br><span class="line">array([[<span class="number">1</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">4</span>],</span><br><span class="line">       [<span class="number">2</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">4</span>]])</span><br></pre></td></tr></table></figure>
<p>6、重建索引</p>
<p><code>reindex(self, index=None, **kwargs))</code></p>
<ul>
<li>method ：ffill前向填充和bfill后向填充和nearest，用前面或后面第一个非空值填充以及最近的非空值填充。</li>
<li>fill_value：缺失数据填充值</li>
<li>columns：传入columns参数对列重建索引</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>s = pd.Series([<span class="number">4.5</span>,<span class="number">2.0</span>,<span class="number">3.5</span>,<span class="number">4.1</span>],index=[<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;d&#x27;</span>])</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s = s.reindex([<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;d&#x27;</span>,<span class="string">&#x27;c&#x27;</span>])</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s</span><br><span class="line">b    <span class="number">2.0</span></span><br><span class="line">a    <span class="number">4.5</span></span><br><span class="line">d    <span class="number">4.1</span></span><br><span class="line">c    <span class="number">3.5</span></span><br><span class="line">dtype: float64</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s = pd.Series(np.arange(<span class="number">3</span>),index=[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>])</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s</span><br><span class="line"><span class="number">1</span>    <span class="number">0</span></span><br><span class="line"><span class="number">2</span>    <span class="number">1</span></span><br><span class="line"><span class="number">3</span>    <span class="number">2</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s.reindex(np.arange(<span class="number">6</span>),method=<span class="string">&#x27;ffill&#x27;</span>)</span><br><span class="line"><span class="number">0</span>    NaN</span><br><span class="line"><span class="number">1</span>    <span class="number">0.0</span></span><br><span class="line"><span class="number">2</span>    <span class="number">1.0</span></span><br><span class="line"><span class="number">3</span>    <span class="number">2.0</span></span><br><span class="line"><span class="number">4</span>    <span class="number">2.0</span></span><br><span class="line"><span class="number">5</span>    <span class="number">2.0</span></span><br><span class="line">dtype: float64</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s.reindex(np.arange(<span class="number">6</span>),method=<span class="string">&#x27;bfill&#x27;</span>)</span><br><span class="line"><span class="number">0</span>    <span class="number">0.0</span></span><br><span class="line"><span class="number">1</span>    <span class="number">0.0</span></span><br><span class="line"><span class="number">2</span>    <span class="number">1.0</span></span><br><span class="line"><span class="number">3</span>    <span class="number">2.0</span></span><br><span class="line"><span class="number">4</span>    NaN</span><br><span class="line"><span class="number">5</span>    NaN</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s.reindex(np.arange(<span class="number">6</span>),fill_value=<span class="number">5</span>)</span><br><span class="line"><span class="number">0</span>    <span class="number">5</span></span><br><span class="line"><span class="number">1</span>    <span class="number">0</span></span><br><span class="line"><span class="number">2</span>    <span class="number">1</span></span><br><span class="line"><span class="number">3</span>    <span class="number">2</span></span><br><span class="line"><span class="number">4</span>    <span class="number">5</span></span><br><span class="line"><span class="number">5</span>    <span class="number">5</span></span><br><span class="line">dtype: int64</span><br></pre></td></tr></table></figure>
<p>7、drop删除条目</p>
<p><code>drop(self, labels=None, axis=0, index=None, columns=None, level=None, inplace=False, errors=&#39;raise&#39;)</code></p>
<ul>
<li>inplace：在原DataFrame上进行修改。</li>
<li>axis：axis=1或axis=’colmumns’在列上删除值。</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>df = pd.DataFrame(np.arange(<span class="number">16</span>).reshape((<span class="number">4</span>,<span class="number">4</span>)),index=[<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;d&#x27;</span>],columns=[<span class="string">&#x27;one&#x27;</span>,<span class="string">&#x27;two&#x27;</span>,<span class="string">&#x27;three&#x27;</span>,<span class="string">&#x27;four&#x27;</span>])</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df.drop([<span class="string">&#x27;one&#x27;</span>],axis=<span class="string">&#x27;columns&#x27;</span>,inplace=<span class="literal">True</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df</span><br><span class="line">   two  three  four</span><br><span class="line">a    <span class="number">1</span>      <span class="number">2</span>     <span class="number">3</span></span><br><span class="line">b    <span class="number">5</span>      <span class="number">6</span>     <span class="number">7</span></span><br><span class="line">c    <span class="number">9</span>     <span class="number">10</span>    <span class="number">11</span></span><br><span class="line">d   <span class="number">13</span>     <span class="number">14</span>    <span class="number">15</span></span><br></pre></td></tr></table></figure>
<p>8、索引选择过滤</p>
<ul>
<li><p><strong>Series的索引包含尾部</strong></p>
</li>
<li><p>DataFrame的[]索引都是针对列而言</p>
</li>
<li><p>布尔索引</p>
</li>
<li><p>loc和iloc：轴标签和整数标签选择行和列的子集</p>
</li>
<li><p>当轴索引包含整数时，使用标签索引。</p>
</li>
<li><p>query：<code>query(expr,inplace=False,**kwargs)</code>，使用布尔表达式查询满足条件的列，对于名字中带有空格的列可以用反引号``引起来。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>df = pd.Series(np.arange(<span class="number">4</span>),index=[<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;d&#x27;</span>])</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df[<span class="string">&#x27;a&#x27;</span>:<span class="string">&#x27;c&#x27;</span>]</span><br><span class="line">a    <span class="number">0</span></span><br><span class="line">b    <span class="number">1</span></span><br><span class="line">c    <span class="number">2</span></span><br><span class="line">dtype: int64</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df[[<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;c&#x27;</span>]]</span><br><span class="line">a    <span class="number">0</span></span><br><span class="line">c    <span class="number">2</span></span><br><span class="line">dtype: int64</span><br><span class="line"><span class="comment">#布尔索引</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df = pd.DataFrame(np.random.randn(<span class="number">4</span>,<span class="number">4</span>),index=[<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;d&#x27;</span>],columns=[<span class="string">&#x27;one&#x27;</span>,<span class="string">&#x27;two&#x27;</span>,<span class="string">&#x27;three&#x27;</span>,<span class="string">&#x27;four&#x27;</span>])</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df[df&lt;<span class="number">0</span>] = <span class="number">0</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df</span><br><span class="line">        one  two     three      four</span><br><span class="line">a  <span class="number">0.000000</span>  <span class="number">0.0</span>  <span class="number">0.049036</span>  <span class="number">0.000000</span></span><br><span class="line">b  <span class="number">0.000000</span>  <span class="number">0.0</span>  <span class="number">0.672880</span>  <span class="number">0.811951</span></span><br><span class="line">c  <span class="number">0.059472</span>  <span class="number">0.0</span>  <span class="number">0.000000</span>  <span class="number">0.070032</span></span><br><span class="line">d  <span class="number">0.176070</span>  <span class="number">0.0</span>  <span class="number">0.000000</span>  <span class="number">1.438983</span></span><br><span class="line"><span class="comment">#loc和iloc</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df = pd.DataFrame(np.random.randn(<span class="number">4</span>,<span class="number">4</span>),index=[<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;d&#x27;</span>],columns=[<span class="string">&#x27;one&#x27;</span>,<span class="string">&#x27;two&#x27;</span>,<span class="string">&#x27;three&#x27;</span>,<span class="string">&#x27;four&#x27;</span>])</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df.loc[<span class="string">&#x27;a&#x27;</span>,[<span class="string">&#x27;one&#x27;</span>,<span class="string">&#x27;two&#x27;</span>]]</span><br><span class="line">one    <span class="number">0.120617</span></span><br><span class="line">two   <span class="number">-0.003955</span></span><br><span class="line">Name: a, dtype: float64</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df.loc[:,<span class="string">&#x27;two&#x27;</span>]</span><br><span class="line">a   <span class="number">-0.003955</span></span><br><span class="line">b    <span class="number">2.162828</span></span><br><span class="line">c    <span class="number">0.780641</span></span><br><span class="line">d    <span class="number">0.794277</span></span><br><span class="line">Name: two, dtype: float64</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df[df&gt;<span class="number">0</span>].iloc[ : ,<span class="number">2</span>]</span><br><span class="line">a         NaN</span><br><span class="line">b    <span class="number">0.421102</span></span><br><span class="line">c    <span class="number">2.133376</span></span><br><span class="line">d         NaN</span><br><span class="line">Name: three, dtype: float64</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>9、算术和数据对齐</p>
<p>​    加、减、乘、整除、除、幂次方</p>
<p>​    add、sub、mul、floordiv、div、pow</p>
<p>​    指定填充值fill_value</p>
<p>10 、函数和映射</p>
<ul>
<li>逐行或逐列：apply</li>
<li>逐元素：applymap</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>df</span><br><span class="line">        one       two     three      four</span><br><span class="line">a  <span class="number">0.120617</span> <span class="number">-0.003955</span> <span class="number">-0.680329</span>  <span class="number">0.646223</span></span><br><span class="line">b <span class="number">-0.846437</span>  <span class="number">2.162828</span>  <span class="number">0.421102</span> <span class="number">-0.431293</span></span><br><span class="line">c <span class="number">-1.806622</span>  <span class="number">0.780641</span>  <span class="number">2.133376</span> <span class="number">-0.782799</span></span><br><span class="line">d  <span class="number">0.099893</span>  <span class="number">0.794277</span> <span class="number">-1.286584</span> <span class="number">-1.032770</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>f = <span class="keyword">lambda</span> x:x.max()-x.min()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df.apply(f)</span><br><span class="line">one      <span class="number">1.927240</span></span><br><span class="line">two      <span class="number">2.166782</span></span><br><span class="line">three    <span class="number">3.419960</span></span><br><span class="line">four     <span class="number">1.678994</span></span><br><span class="line">dtype: float64</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df.apply(f,axis=<span class="string">&#x27;columns&#x27;</span>)</span><br><span class="line">a    <span class="number">1.326553</span></span><br><span class="line">b    <span class="number">3.009265</span></span><br><span class="line">c    <span class="number">3.939998</span></span><br><span class="line">d    <span class="number">2.080861</span></span><br><span class="line">dtype: float64</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="function"><span class="keyword">def</span> <span class="title">f</span>(<span class="params">x</span>):</span></span><br><span class="line"><span class="meta">... </span>    <span class="keyword">return</span> pd.Series([x.min(),x.max()],index=[<span class="string">&#x27;max&#x27;</span>,<span class="string">&#x27;min&#x27;</span>])</span><br><span class="line"><span class="meta">... </span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df.apply(f)</span><br><span class="line">          one       two     three      four</span><br><span class="line">max <span class="number">-1.806622</span> <span class="number">-0.003955</span> <span class="number">-1.286584</span> <span class="number">-1.032770</span></span><br><span class="line">min  <span class="number">0.120617</span>  <span class="number">2.162828</span>  <span class="number">2.133376</span>  <span class="number">0.646223</span></span><br><span class="line"><span class="comment">#applymap</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>format = <span class="keyword">lambda</span> x: <span class="string">&#x27;%.2f&#x27;</span> % x</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df.applymap(format)</span><br><span class="line">     one    two  three   four</span><br><span class="line">a   <span class="number">0.12</span>  <span class="number">-0.00</span>  <span class="number">-0.68</span>   <span class="number">0.65</span></span><br><span class="line">b  <span class="number">-0.85</span>   <span class="number">2.16</span>   <span class="number">0.42</span>  <span class="number">-0.43</span></span><br><span class="line">c  <span class="number">-1.81</span>   <span class="number">0.78</span>   <span class="number">2.13</span>  <span class="number">-0.78</span></span><br><span class="line">d   <span class="number">0.10</span>   <span class="number">0.79</span>  <span class="number">-1.29</span>  <span class="number">-1.03</span></span><br></pre></td></tr></table></figure>
<p>11、排序排名</p>
<ul>
<li><p>sort_index()：ascending=False</p>
</li>
<li><p>sort_values()：默认情况下所有缺失值都会排序至尾部，对于DataFrame通过by参数传入排序键，按照键的顺序依次比较。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>df = pd.DataFrame(&#123;<span class="string">&#x27;b&#x27;</span>:[<span class="number">4</span>,<span class="number">7</span>,<span class="number">-3</span>,<span class="number">2</span>],<span class="string">&#x27;a&#x27;</span>:[<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>]&#125;)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df</span><br><span class="line">   b  a</span><br><span class="line"><span class="number">0</span>  <span class="number">4</span>  <span class="number">0</span></span><br><span class="line"><span class="number">1</span>  <span class="number">7</span>  <span class="number">1</span></span><br><span class="line"><span class="number">2</span> <span class="number">-3</span>  <span class="number">0</span></span><br><span class="line"><span class="number">3</span>  <span class="number">2</span>  <span class="number">1</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df.sort_values(by=[<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;a&#x27;</span>])</span><br><span class="line">   b  a</span><br><span class="line"><span class="number">2</span> <span class="number">-3</span>  <span class="number">0</span></span><br><span class="line"><span class="number">3</span>  <span class="number">2</span>  <span class="number">1</span></span><br><span class="line"><span class="number">0</span>  <span class="number">4</span>  <span class="number">0</span></span><br><span class="line"><span class="number">1</span>  <span class="number">7</span>  <span class="number">1</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
<li><p>rank：常用参数axis=0，method=’average’，na_option=’keep’，ascending=True</p>
<p>method:average,min(对整个组使用最小排名),max,first,dense(组间排名增加1)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>df = pd.DataFrame(&#123;<span class="string">&#x27;b&#x27;</span>:[<span class="number">4.3</span>,<span class="number">7</span>,<span class="number">-3</span>,<span class="number">2</span>],<span class="string">&#x27;a&#x27;</span>:[<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>],<span class="string">&#x27;c&#x27;</span>:[<span class="number">0</span>,<span class="number">5</span>,<span class="number">8</span>,<span class="number">-2.5</span>]&#125;)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df.rank(axis=<span class="string">&#x27;columns&#x27;</span>,method=<span class="string">&#x27;min&#x27;</span>)</span><br><span class="line">     b    a    c</span><br><span class="line"><span class="number">0</span>  <span class="number">3.0</span>  <span class="number">1.0</span>  <span class="number">1.0</span></span><br><span class="line"><span class="number">1</span>  <span class="number">3.0</span>  <span class="number">1.0</span>  <span class="number">2.0</span></span><br><span class="line"><span class="number">2</span>  <span class="number">1.0</span>  <span class="number">2.0</span>  <span class="number">3.0</span></span><br><span class="line"><span class="number">3</span>  <span class="number">3.0</span>  <span class="number">2.0</span>  <span class="number">1.0</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df.rank(axis=<span class="string">&#x27;columns&#x27;</span>,method=<span class="string">&#x27;dense&#x27;</span>)</span><br><span class="line">     b    a    c</span><br><span class="line"><span class="number">0</span>  <span class="number">2.0</span>  <span class="number">1.0</span>  <span class="number">1.0</span></span><br><span class="line"><span class="number">1</span>  <span class="number">3.0</span>  <span class="number">1.0</span>  <span class="number">2.0</span></span><br><span class="line"><span class="number">2</span>  <span class="number">1.0</span>  <span class="number">2.0</span>  <span class="number">3.0</span></span><br><span class="line"><span class="number">3</span>  <span class="number">3.0</span>  <span class="number">2.0</span>  <span class="number">1.0</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>12、统计概述计算</p>
<ul>
<li><p>describe：概要</p>
</li>
<li><p>cov&amp;corr：协方差和相关系数</p>
</li>
<li><p>value_counts：返回一个Series，索引是唯一值序列，值是计数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>data = np.random.randint(<span class="number">0</span>,<span class="number">7</span>,size=<span class="number">50</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>data</span><br><span class="line">array([<span class="number">3</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">3</span>, <span class="number">6</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">6</span>,</span><br><span class="line">       <span class="number">0</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">6</span>,</span><br><span class="line">       <span class="number">0</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">5</span>])</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s = pd.Series(data)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s.value_counts()</span><br><span class="line"><span class="number">6</span>    <span class="number">11</span></span><br><span class="line"><span class="number">3</span>     <span class="number">9</span></span><br><span class="line"><span class="number">1</span>     <span class="number">9</span></span><br><span class="line"><span class="number">4</span>     <span class="number">7</span></span><br><span class="line"><span class="number">5</span>     <span class="number">6</span></span><br><span class="line"><span class="number">2</span>     <span class="number">4</span></span><br><span class="line"><span class="number">0</span>     <span class="number">4</span></span><br><span class="line">dtype: int64</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>data = pd.DataFrame(&#123;<span class="string">&#x27;Qu1&#x27;</span>:[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>],<span class="string">&#x27;Qu2&#x27;</span>:[<span class="number">3</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">4</span>,<span class="number">2</span>],<span class="string">&#x27;Qu3&#x27;</span>:[<span class="number">1</span>,<span class="number">5</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">5</span>]&#125;)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>data</span><br><span class="line">   Qu1  Qu2  Qu3</span><br><span class="line"><span class="number">0</span>    <span class="number">1</span>    <span class="number">3</span>    <span class="number">1</span></span><br><span class="line"><span class="number">1</span>    <span class="number">2</span>    <span class="number">2</span>    <span class="number">5</span></span><br><span class="line"><span class="number">2</span>    <span class="number">3</span>    <span class="number">1</span>    <span class="number">2</span></span><br><span class="line"><span class="number">3</span>    <span class="number">4</span>    <span class="number">4</span>    <span class="number">4</span></span><br><span class="line"><span class="number">4</span>    <span class="number">5</span>    <span class="number">2</span>    <span class="number">5</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>data.value_counts()</span><br><span class="line">Qu1  Qu2  Qu3</span><br><span class="line"><span class="number">5</span>    <span class="number">2</span>    <span class="number">5</span>      <span class="number">1</span></span><br><span class="line"><span class="number">4</span>    <span class="number">4</span>    <span class="number">4</span>      <span class="number">1</span></span><br><span class="line"><span class="number">3</span>    <span class="number">1</span>    <span class="number">2</span>      <span class="number">1</span></span><br><span class="line"><span class="number">2</span>    <span class="number">2</span>    <span class="number">5</span>      <span class="number">1</span></span><br><span class="line"><span class="number">1</span>    <span class="number">3</span>    <span class="number">1</span>      <span class="number">1</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="数据载入"><a href="#数据载入" class="headerlink" title="数据载入"></a>数据载入</h3><p>1、数据载入</p>
<blockquote>
<p>read_csv：从文件中读取分隔好的数据，默认分隔符是逗号。</p>
<p>常用参数</p>
<ul>
<li>file_path：文件型对象路径。</li>
<li>seq=’,’：分隔符，可能要使用\s+</li>
<li>header=0：作为列名的行，默认情况下将第一行作为列名。</li>
<li>names：要使用的列名列表，如果文件包含标题行，则应显式传递header = 0以覆盖列名。</li>
<li>index_col：要作为索引的列。</li>
<li>skiprows：在文件开始处要跳过的行号或要跳过的行数。列表、整数或函数都可。</li>
<li>na_values：传入列表或字符串来处理缺失值。</li>
<li>converters：用于在某些列中转换值的函数的字典。键可以是整数或列标签</li>
</ul>
<p>分块读取大文件</p>
<ul>
<li>nrows：要读取的文件行数。</li>
<li>chunksize：每一块的行数，返回TextFileReader对象以进行迭代。</li>
</ul>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">chunker = pd.read_csv(<span class="string">&#x27;examples/ex6/csv&#x27;</span>,chunksize=<span class="number">1000</span>)</span><br><span class="line">tot = pd.Series([])</span><br><span class="line"><span class="keyword">for</span> piece <span class="keyword">in</span> chunker:</span><br><span class="line">    tot = tot.add(piece[<span class="string">&#x27;key&#x27;</span>].value_counts(),fill_values=<span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<h3 id="数据清洗"><a href="#数据清洗" class="headerlink" title="数据清洗"></a>数据清洗</h3><p>1、缺失值处理</p>
<p>处理方法</p>
<ul>
<li><p><code>dropna: axis,how&#123;any,all&#125;,thresh,inplace</code></p>
</li>
<li><p><code>fillna(self, value=None, method=None, axis=None, inplace=False, limit=None, downcast=None, **kwargs):method : &#123;&#39;backfill&#39;, &#39;bfill&#39;, &#39;pad&#39;, &#39;ffill&#39;, None&#125;，返回一个新对象</code></p>
</li>
<li><p><code>isna</code></p>
</li>
<li><p><code>notna</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">8</span>]: df.reindex(columns=(<span class="string">&#x27;one&#x27;</span>,<span class="string">&#x27;two&#x27;</span>,<span class="string">&#x27;three&#x27;</span>))</span><br><span class="line">Out[<span class="number">8</span>]:</span><br><span class="line">   one       two     three</span><br><span class="line">a  NaN <span class="number">-0.948069</span>  <span class="number">0.311691</span></span><br><span class="line">c  NaN <span class="number">-1.182283</span> <span class="number">-1.637207</span></span><br><span class="line">e  NaN <span class="number">-0.575290</span>  <span class="number">0.604738</span></span><br><span class="line">f  NaN <span class="number">-0.173433</span>  <span class="number">0.529142</span></span><br><span class="line">h  NaN  <span class="number">0.082779</span> <span class="number">-0.062904</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">9</span>]: df.dropna(axis=<span class="number">1</span>)</span><br><span class="line">Out[<span class="number">9</span>]:</span><br><span class="line">        two     three</span><br><span class="line">a <span class="number">-0.948069</span>  <span class="number">0.311691</span></span><br><span class="line">c <span class="number">-1.182283</span> <span class="number">-1.637207</span></span><br><span class="line">e <span class="number">-0.575290</span>  <span class="number">0.604738</span></span><br><span class="line">f <span class="number">-0.173433</span>  <span class="number">0.529142</span></span><br><span class="line">h  <span class="number">0.082779</span> <span class="number">-0.062904</span></span><br><span class="line"><span class="comment">#fillna</span></span><br><span class="line">In [<span class="number">14</span>]: df</span><br><span class="line">Out[<span class="number">14</span>]:</span><br><span class="line">   zero       one       two</span><br><span class="line">a   NaN  <span class="number">0.082711</span> <span class="number">-1.467707</span></span><br><span class="line">b   NaN <span class="number">-0.306878</span>       NaN</span><br><span class="line">c   NaN <span class="number">-0.348060</span> <span class="number">-3.202079</span></span><br><span class="line">In [<span class="number">16</span>]: df.fillna(method=<span class="string">&#x27;pad&#x27;</span>)</span><br><span class="line">Out[<span class="number">16</span>]:</span><br><span class="line">   zero       one       two</span><br><span class="line">a   NaN  <span class="number">0.082711</span> <span class="number">-1.467707</span></span><br><span class="line">b   NaN <span class="number">-0.306878</span> <span class="number">-1.467707</span></span><br><span class="line">c   NaN <span class="number">-0.348060</span> <span class="number">-3.202079</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>2、映射替代</p>
<ul>
<li><p>replace：修改对象子集的值，替代</p>
</li>
<li><p>map：接受一个函数或字典进行映射</p>
</li>
<li><p>rename：接受一个函数或字典进行标签重命名，inplace参数。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">29</span>]: data = pd.Series([<span class="number">1</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">3</span>,<span class="number">3</span>])</span><br><span class="line"></span><br><span class="line">In [<span class="number">30</span>]: data.replace(&#123;<span class="number">1</span>:<span class="number">666</span>,<span class="number">3</span>:<span class="string">&#x27;SIXSIXSIX&#x27;</span>&#125;)</span><br><span class="line">Out[<span class="number">30</span>]:</span><br><span class="line"><span class="number">0</span>          <span class="number">666</span></span><br><span class="line"><span class="number">1</span>            <span class="number">4</span></span><br><span class="line"><span class="number">2</span>            <span class="number">5</span></span><br><span class="line"><span class="number">3</span>    SIXSIXSIX</span><br><span class="line"><span class="number">4</span>    SIXSIXSIX</span><br><span class="line">dtype: object</span><br><span class="line">In [<span class="number">33</span>]: data.rename(index=&#123;<span class="number">1</span>:<span class="string">&#x27;one&#x27;</span>,<span class="number">2</span>:<span class="string">&#x27;two&#x27;</span>&#125;)</span><br><span class="line">Out[<span class="number">33</span>]:</span><br><span class="line"><span class="number">0</span>      <span class="number">1</span></span><br><span class="line">one    <span class="number">4</span></span><br><span class="line">two    <span class="number">5</span></span><br><span class="line"><span class="number">3</span>      <span class="number">3</span></span><br><span class="line"><span class="number">4</span>      <span class="number">3</span></span><br><span class="line">dtype: int64</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>3、离散化分箱</p>
<ul>
<li><p>cut：返回Categorical对象，传入labels选项自定义箱名。</p>
</li>
<li><p>qcut：按照分位数划分数据分箱，还可以传入自定义分位数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">35</span>]: ages = np.random.randint(<span class="number">0</span>,<span class="number">80</span>,size=<span class="number">15</span>)</span><br><span class="line"></span><br><span class="line">In [<span class="number">36</span>]: ages</span><br><span class="line">Out[<span class="number">36</span>]: array([<span class="number">41</span>, <span class="number">27</span>, <span class="number">71</span>, <span class="number">43</span>, <span class="number">15</span>,  <span class="number">2</span>, <span class="number">41</span>, <span class="number">72</span>, <span class="number">33</span>, <span class="number">47</span>, <span class="number">71</span>, <span class="number">72</span>,  <span class="number">7</span>, <span class="number">78</span>, <span class="number">32</span>])</span><br><span class="line"></span><br><span class="line">In [<span class="number">37</span>]: bins = [<span class="number">18</span>,<span class="number">25</span>,<span class="number">35</span>,<span class="number">60</span>,<span class="number">100</span>]</span><br><span class="line">In [<span class="number">42</span>]: pd.cut(ages,bins)</span><br><span class="line">Out[<span class="number">42</span>]:</span><br><span class="line">[(<span class="number">35.0</span>, <span class="number">60.0</span>], (<span class="number">25.0</span>, <span class="number">35.0</span>], (<span class="number">60.0</span>, <span class="number">100.0</span>], (<span class="number">35.0</span>, <span class="number">60.0</span>], NaN, ..., (<span class="number">60.0</span>, <span class="number">100.0</span>], (<span class="number">60.0</span>, <span class="number">100.0</span>], NaN, (<span class="number">60.0</span>, <span class="number">100.0</span>], (<span class="number">25.0</span>, <span class="number">35.0</span>]]</span><br><span class="line">Length: <span class="number">15</span></span><br><span class="line">Categories (<span class="number">4</span>, interval[int64]): [(<span class="number">18</span>, <span class="number">25</span>] &lt; (<span class="number">25</span>, <span class="number">35</span>] &lt; (<span class="number">35</span>, <span class="number">60</span>] &lt; (<span class="number">60</span>, <span class="number">100</span>]]</span><br><span class="line">In [<span class="number">43</span>]: cats = pd.cut(ages,bins)</span><br><span class="line"></span><br><span class="line">In [<span class="number">44</span>]: cats.codes</span><br><span class="line">Out[<span class="number">44</span>]:</span><br><span class="line">array([ <span class="number">2</span>,  <span class="number">1</span>,  <span class="number">3</span>,  <span class="number">2</span>, <span class="number">-1</span>, <span class="number">-1</span>,  <span class="number">2</span>,  <span class="number">3</span>,  <span class="number">1</span>,  <span class="number">2</span>,  <span class="number">3</span>,  <span class="number">3</span>, <span class="number">-1</span>,  <span class="number">3</span>,  <span class="number">1</span>],</span><br><span class="line">      dtype=int8)                                                                 In [<span class="number">50</span>]: cats.value_counts()</span><br><span class="line">Out[<span class="number">50</span>]:</span><br><span class="line">(<span class="number">18</span>, <span class="number">25</span>]     <span class="number">0</span></span><br><span class="line">(<span class="number">25</span>, <span class="number">35</span>]     <span class="number">3</span></span><br><span class="line">(<span class="number">35</span>, <span class="number">60</span>]     <span class="number">4</span></span><br><span class="line">(<span class="number">60</span>, <span class="number">100</span>]    <span class="number">5</span></span><br><span class="line">dtype: int64   </span><br><span class="line"><span class="comment">#qcut</span></span><br><span class="line">In [<span class="number">58</span>]: cats = pd.qcut(data,[<span class="number">0</span>,<span class="number">0.5</span>,<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">In [<span class="number">59</span>]: cats.value_counts()</span><br><span class="line">Out[<span class="number">59</span>]:</span><br><span class="line">(<span class="number">-3.4259999999999997</span>, <span class="number">0.0193</span>]    <span class="number">500</span></span><br><span class="line">(<span class="number">0.0193</span>, <span class="number">3.795</span>]                  <span class="number">500</span></span><br><span class="line">dtype: int64</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>4、计算指标</p>
<p><code>pd.get_dummies:prefix</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">2</span>]: s = pd.Series(list(<span class="string">&#x27;abc&#x27;</span>))</span><br><span class="line">In [<span class="number">4</span>]: pd.get_dummies(s)</span><br><span class="line">Out[<span class="number">4</span>]:</span><br><span class="line">   a  b  c</span><br><span class="line"><span class="number">0</span>  <span class="number">1</span>  <span class="number">0</span>  <span class="number">0</span></span><br><span class="line"><span class="number">1</span>  <span class="number">0</span>  <span class="number">1</span>  <span class="number">0</span></span><br><span class="line"><span class="number">2</span>  <span class="number">0</span>  <span class="number">0</span>  <span class="number">1</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="数据规整"><a href="#数据规整" class="headerlink" title="数据规整"></a>数据规整</h3><p>1、分层索引</p>
<p>stack：从指定界别的列堆叠到行索引</p>
<ul>
<li>如果列具有单个级别，则输出为Series。</li>
</ul>
<p><code>pd.DataFrame.stack(self, level=-1, dropna=True)</code></p>
<p>unstack：透视一个指定级别（必须是分层的）的行索引</p>
<ul>
<li>当列不是多层索引时，输出一个DataFrame，模拟stack的效果。</li>
</ul>
<p><code>pd.DataFrame.unstack(self, level=-1, fill_value=None)</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">13</span>]: data</span><br><span class="line">Out[<span class="number">13</span>]:</span><br><span class="line">     weight  height</span><br><span class="line">cat       <span class="number">0</span>       <span class="number">1</span></span><br><span class="line">dog       <span class="number">2</span>       <span class="number">3</span></span><br><span class="line"><span class="comment">#stack</span></span><br><span class="line">In [<span class="number">14</span>]: data.stack()</span><br><span class="line">Out[<span class="number">14</span>]:</span><br><span class="line">cat  weight    <span class="number">0</span></span><br><span class="line">     height    <span class="number">1</span></span><br><span class="line">dog  weight    <span class="number">2</span></span><br><span class="line">     height    <span class="number">3</span></span><br><span class="line">dtype: int64</span><br><span class="line"><span class="comment">#unstack</span></span><br><span class="line">In [<span class="number">15</span>]:s</span><br><span class="line">Out[<span class="number">15</span>]:</span><br><span class="line">one  a   <span class="number">1.0</span></span><br><span class="line">     b   <span class="number">2.0</span></span><br><span class="line">two  a   <span class="number">3.0</span></span><br><span class="line">     b   <span class="number">4.0</span></span><br><span class="line">dtype: float64</span><br><span class="line">In [<span class="number">23</span>]: a = s.unstack(<span class="number">0</span>)</span><br><span class="line">In [<span class="number">24</span>]: a</span><br><span class="line">Out[<span class="number">24</span>]:</span><br><span class="line">   one  two</span><br><span class="line">a  <span class="number">1.0</span>  <span class="number">3.0</span></span><br><span class="line">b  <span class="number">2.0</span>  <span class="number">4.0</span></span><br><span class="line">In [<span class="number">25</span>]: a.unstack()</span><br><span class="line">Out[<span class="number">25</span>]:</span><br><span class="line">one  a    <span class="number">1.0</span></span><br><span class="line">     b    <span class="number">2.0</span></span><br><span class="line">two  a    <span class="number">3.0</span></span><br><span class="line">     b    <span class="number">4.0</span></span><br><span class="line">dtype: float6</span><br></pre></td></tr></table></figure>
<p>2、合并</p>
<ul>
<li><p>merge/join：数据库风格连接</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">pd.merge(left, right, how=<span class="string">&#x27;inner&#x27;</span>, on=<span class="literal">None</span>, left_on=<span class="literal">None</span>, right_on=<span class="literal">None</span>,</span><br><span class="line">         left_index=<span class="literal">False</span>, right_index=<span class="literal">False</span>, sort=<span class="literal">True</span>,</span><br><span class="line">         suffixes=(<span class="string">&#x27;_x&#x27;</span>, <span class="string">&#x27;_y&#x27;</span>), copy=<span class="literal">True</span>, indicator=<span class="literal">False</span>,</span><br><span class="line">         validate=<span class="literal">None</span>)</span><br><span class="line">left_index&amp;right_index:使用左边或右边的索引标签进行连接    bool  </span><br><span class="line">suffixes:对于两边重复列名添加后缀</span><br><span class="line">DataFrame.join(other, on=<span class="literal">None</span>, how=<span class="string">&#x27;left&#x27;</span>, lsuffix=<span class="string">&#x27;&#x27;</span>, rsuffix=<span class="string">&#x27;&#x27;</span>, sort=<span class="literal">False</span>)</span><br><span class="line">用于索引-索引连接</span><br></pre></td></tr></table></figure>
</li>
<li><p>concat：级联堆叠</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">pd.concat(objs, axis=<span class="number">0</span>, join=<span class="string">&#x27;outer&#x27;</span>, ignore_index=<span class="literal">False</span>, keys=<span class="literal">None</span>,</span><br><span class="line">          levels=<span class="literal">None</span>, names=<span class="literal">None</span>, verify_integrity=<span class="literal">False</span>, copy=<span class="literal">True</span>)</span><br><span class="line">join=&#123;<span class="string">&#x27;outer&#x27;</span>,<span class="string">&#x27;inner&#x27;</span>&#125;          </span><br><span class="line">keys:进行分层，实现一个分层索引</span><br><span class="line">levels:</span><br><span class="line">names:为分层索引命名</span><br><span class="line">ignore_index:    </span><br></pre></td></tr></table></figure>
</li>
<li><p>combine_first：根据传入的对象来修补，填充nan值。</p>
<p>a.combine_first(b) == np.where(pd.isnull(a),b,a)</p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#merge</span></span><br><span class="line">In [<span class="number">24</span>]: df1</span><br><span class="line">Out[<span class="number">24</span>]:</span><br><span class="line">  key  data1</span><br><span class="line"><span class="number">0</span>   b      <span class="number">0</span></span><br><span class="line"><span class="number">1</span>   b      <span class="number">1</span></span><br><span class="line"><span class="number">2</span>   a      <span class="number">2</span></span><br><span class="line"><span class="number">3</span>   c      <span class="number">3</span></span><br><span class="line"><span class="number">4</span>   a      <span class="number">4</span></span><br><span class="line"><span class="number">5</span>   b      <span class="number">5</span></span><br><span class="line">  </span><br><span class="line">In [<span class="number">25</span>]: df2</span><br><span class="line">Out[<span class="number">25</span>]:</span><br><span class="line">  key  data2</span><br><span class="line"><span class="number">0</span>   a      <span class="number">0</span></span><br><span class="line"><span class="number">1</span>   b      <span class="number">1</span></span><br><span class="line"><span class="number">2</span>   a      <span class="number">2</span></span><br><span class="line"><span class="number">3</span>   b      <span class="number">3</span></span><br><span class="line"><span class="number">4</span>   d      <span class="number">4</span></span><br><span class="line">In [<span class="number">27</span>]: pd.merge(df1,df2,on=<span class="string">&#x27;key&#x27;</span>,how=<span class="string">&#x27;inner&#x27;</span>)</span><br><span class="line">Out[<span class="number">27</span>]:</span><br><span class="line">  key  data1  data2</span><br><span class="line"><span class="number">0</span>   b      <span class="number">0</span>      <span class="number">1</span></span><br><span class="line"><span class="number">1</span>   b      <span class="number">0</span>      <span class="number">3</span></span><br><span class="line"><span class="number">2</span>   b      <span class="number">1</span>      <span class="number">1</span></span><br><span class="line"><span class="number">3</span>   b      <span class="number">1</span>      <span class="number">3</span></span><br><span class="line"><span class="number">4</span>   b      <span class="number">5</span>      <span class="number">1</span></span><br><span class="line"><span class="number">5</span>   b      <span class="number">5</span>      <span class="number">3</span></span><br><span class="line"><span class="number">6</span>   a      <span class="number">2</span>      <span class="number">0</span></span><br><span class="line"><span class="number">7</span>   a      <span class="number">2</span>      <span class="number">2</span></span><br><span class="line"><span class="number">8</span>   a      <span class="number">4</span>      <span class="number">0</span></span><br><span class="line"><span class="number">9</span>   a      <span class="number">4</span>      <span class="number">2</span></span><br><span class="line">In [<span class="number">30</span>]: df1</span><br><span class="line">Out[<span class="number">30</span>]:</span><br><span class="line">          a         b         c         d</span><br><span class="line"><span class="number">0</span> <span class="number">-0.688051</span> <span class="number">-1.687689</span> <span class="number">-1.821879</span>  <span class="number">1.049606</span></span><br><span class="line"><span class="number">1</span>  <span class="number">0.030669</span> <span class="number">-1.175769</span>  <span class="number">0.098271</span> <span class="number">-0.379142</span></span><br><span class="line"><span class="number">2</span> <span class="number">-0.803439</span> <span class="number">-0.887358</span> <span class="number">-0.970493</span>  <span class="number">0.266721</span></span><br><span class="line">  </span><br><span class="line">In [<span class="number">31</span>]: df2</span><br><span class="line">Out[<span class="number">31</span>]:</span><br><span class="line">          b         d         a</span><br><span class="line"><span class="number">0</span> <span class="number">-0.945324</span> <span class="number">-0.703304</span> <span class="number">-1.338908</span></span><br><span class="line"><span class="number">1</span>  <span class="number">0.292692</span>  <span class="number">1.830330</span> <span class="number">-0.249309</span></span><br><span class="line">In [<span class="number">34</span>]: pd.concat([df1,df2],ignore_index=<span class="literal">True</span>,sort=<span class="literal">False</span>)</span><br><span class="line">Out[<span class="number">34</span>]:</span><br><span class="line">          a         b         c         d</span><br><span class="line"><span class="number">0</span> <span class="number">-0.688051</span> <span class="number">-1.687689</span> <span class="number">-1.821879</span>  <span class="number">1.049606</span></span><br><span class="line"><span class="number">1</span>  <span class="number">0.030669</span> <span class="number">-1.175769</span>  <span class="number">0.098271</span> <span class="number">-0.379142</span></span><br><span class="line"><span class="number">2</span> <span class="number">-0.803439</span> <span class="number">-0.887358</span> <span class="number">-0.970493</span>  <span class="number">0.266721</span></span><br><span class="line"><span class="number">3</span> <span class="number">-1.338908</span> <span class="number">-0.945324</span>       NaN <span class="number">-0.703304</span></span><br><span class="line"><span class="number">4</span> <span class="number">-0.249309</span>  <span class="number">0.292692</span>       NaN  <span class="number">1.830330</span></span><br><span class="line"><span class="comment">#combine_first</span></span><br><span class="line">  </span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>3、透视pivot和melt</p>
<ul>
<li><p><code>pandas.pivot(data,index=None,columns=None, values=None)</code></p>
<p>将一列变成许多列</p>
</li>
<li><p><code>melt(frame, id_vars=None, value_vars=None, var_name=None, value_name=&#39;value&#39;, col_level=None)</code></p>
<p>将许多列合并为一列</p>
</li>
<li><p><code>pivot_table(values=None, index=None, columns=None, aggfunc=&#39;mean&#39;, fill_value=None, margins=False, dropna=True, margins_name=&#39;All&#39;, observed=False)</code></p>
</li>
</ul>
<blockquote>
<p>margins：添加行/列小计</p>
<p>margins_name：指定名字</p>
</blockquote>
<ul>
<li><code>crosstab(index, columns, values=None, rownames=None, colnames=None, aggfunc=None, margins=False, margins_name=&#39;All&#39;, dropna=True, normalize=False)</code></li>
</ul>
<blockquote>
<p>crosstab是数据透视表的特殊情况，计算分组中的频率。</p>
<p>normalize：通过将所有值除以值的总和进行归一化</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">41</span>]: df</span><br><span class="line">Out[<span class="number">41</span>]:</span><br><span class="line">   foo bar  baz zoo</span><br><span class="line"><span class="number">0</span>  one   A    <span class="number">1</span>   x</span><br><span class="line"><span class="number">1</span>  one   B    <span class="number">2</span>   y</span><br><span class="line"><span class="number">2</span>  one   C    <span class="number">3</span>   z</span><br><span class="line"><span class="number">3</span>  two   A    <span class="number">4</span>   q</span><br><span class="line"><span class="number">4</span>  two   B    <span class="number">5</span>   w</span><br><span class="line"><span class="number">5</span>  two   C    <span class="number">6</span>   t</span><br><span class="line">In [<span class="number">43</span>]: pd.pivot(df,index=<span class="string">&#x27;foo&#x27;</span>,columns=<span class="string">&#x27;bar&#x27;</span>,values=<span class="string">&#x27;baz&#x27;</span>)</span><br><span class="line">Out[<span class="number">43</span>]:</span><br><span class="line">bar  A  B  C</span><br><span class="line">foo</span><br><span class="line">one  <span class="number">1</span>  <span class="number">2</span>  <span class="number">3</span></span><br><span class="line">two  <span class="number">4</span>  <span class="number">5</span>  <span class="number">6</span></span><br><span class="line">In [<span class="number">44</span>]: pd.pivot(df,index=<span class="string">&#x27;foo&#x27;</span>,columns=<span class="string">&#x27;bar&#x27;</span>,values=[<span class="string">&#x27;baz&#x27;</span>,<span class="string">&#x27;zoo&#x27;</span>])</span><br><span class="line">Out[<span class="number">44</span>]:</span><br><span class="line">    baz       zoo</span><br><span class="line">bar   A  B  C   A  B  C</span><br><span class="line">foo</span><br><span class="line">one   <span class="number">1</span>  <span class="number">2</span>  <span class="number">3</span>   x  y  z</span><br><span class="line">two   <span class="number">4</span>  <span class="number">5</span>  <span class="number">6</span>   q  w  t</span><br><span class="line"><span class="comment">#melt</span></span><br><span class="line">In [<span class="number">3</span>]: df</span><br><span class="line">Out[<span class="number">3</span>]:</span><br><span class="line">   key  A  B  C</span><br><span class="line"><span class="number">0</span>  foo  <span class="number">1</span>  <span class="number">4</span>  <span class="number">7</span></span><br><span class="line"><span class="number">1</span>  bar  <span class="number">2</span>  <span class="number">5</span>  <span class="number">8</span></span><br><span class="line"><span class="number">2</span>  baz  <span class="number">3</span>  <span class="number">6</span>  <span class="number">9</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">4</span>]: pd.melt(df,[<span class="string">&#x27;key&#x27;</span>])</span><br><span class="line">Out[<span class="number">4</span>]:</span><br><span class="line">   key variable  value</span><br><span class="line"><span class="number">0</span>  foo        A      <span class="number">1</span></span><br><span class="line"><span class="number">1</span>  bar        A      <span class="number">2</span></span><br><span class="line"><span class="number">2</span>  baz        A      <span class="number">3</span></span><br><span class="line"><span class="number">3</span>  foo        B      <span class="number">4</span></span><br><span class="line"><span class="number">4</span>  bar        B      <span class="number">5</span></span><br><span class="line"><span class="number">5</span>  baz        B      <span class="number">6</span></span><br><span class="line"><span class="number">6</span>  foo        C      <span class="number">7</span></span><br><span class="line"><span class="number">7</span>  bar        C      <span class="number">8</span></span><br><span class="line"><span class="number">8</span>  baz        C      <span class="number">9</span></span><br></pre></td></tr></table></figure>
<h3 id="聚合与分组"><a href="#聚合与分组" class="headerlink" title="聚合与分组"></a>聚合与分组</h3><p>1、split-apply-combine</p>
<p>1）分组</p>
<p><code>DataFrame.groupby(by=None,axis=0,level=None,as_index=True,sort=True,group_keys=True,squeeze=False,observed=False,dropna=True)</code></p>
<blockquote>
<ul>
<li><p>返回GroupBy对象</p>
</li>
<li><p>by：可以是Series、list、mapping、function、label，传入字典或Series映射或函数分组</p>
</li>
<li>axis：沿行（0）或列（1）拆分</li>
<li>level：如果轴是MultiIndex（分层），则按一个或多个特定级别分组</li>
<li>as_index：禁用分组键作为索引，reset_index可以实现同样功能</li>
</ul>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">20</span>]: df</span><br><span class="line">Out[<span class="number">20</span>]:</span><br><span class="line">  key1 key2     data1     data2</span><br><span class="line"><span class="number">0</span>    a  one <span class="number">-1.066519</span> <span class="number">-0.329629</span></span><br><span class="line"><span class="number">1</span>    a  two <span class="number">-0.753174</span>  <span class="number">1.384481</span></span><br><span class="line"><span class="number">2</span>    b  one  <span class="number">2.126111</span> <span class="number">-0.563764</span></span><br><span class="line"><span class="number">3</span>    b  two  <span class="number">0.230070</span>  <span class="number">0.232354</span></span><br><span class="line"><span class="number">4</span>    a  one  <span class="number">0.835789</span> <span class="number">-0.289843</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line">In [<span class="number">21</span>]: df.groupby(df[<span class="string">&#x27;key1&#x27;</span>]).mean()</span><br><span class="line">Out[<span class="number">21</span>]:</span><br><span class="line">         data1     data2</span><br><span class="line">key1</span><br><span class="line">a    <span class="number">-0.327968</span>  <span class="number">0.255003</span></span><br><span class="line">b     <span class="number">1.178091</span> <span class="number">-0.165705</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">22</span>]: df.groupby(<span class="string">&#x27;key1&#x27;</span>).mean()</span><br><span class="line">Out[<span class="number">22</span>]:</span><br><span class="line">         data1     data2</span><br><span class="line">key1</span><br><span class="line">a    <span class="number">-0.327968</span>  <span class="number">0.255003</span></span><br><span class="line">b     <span class="number">1.178091</span> <span class="number">-0.165705</span></span><br><span class="line"><span class="comment">#通过组名、数据块迭代</span></span><br><span class="line">In [<span class="number">24</span>]: <span class="keyword">for</span> name,group <span class="keyword">in</span> df.groupby(<span class="string">&#x27;key1&#x27;</span>):</span><br><span class="line">    ...:     print(name,group)</span><br><span class="line">    ...:</span><br><span class="line">    ...:</span><br><span class="line">a   key1 key2     data1     data2</span><br><span class="line"><span class="number">0</span>    a  one <span class="number">-1.066519</span> <span class="number">-0.329629</span></span><br><span class="line"><span class="number">1</span>    a  two <span class="number">-0.753174</span>  <span class="number">1.384481</span></span><br><span class="line"><span class="number">4</span>    a  one  <span class="number">0.835789</span> <span class="number">-0.289843</span></span><br><span class="line">b   key1 key2     data1     data2</span><br><span class="line"><span class="number">2</span>    b  one  <span class="number">2.126111</span> <span class="number">-0.563764</span></span><br><span class="line"><span class="number">3</span>    b  two  <span class="number">0.230070</span>  <span class="number">0.232354</span></span><br><span class="line"><span class="comment">#按照index的长度分组</span></span><br><span class="line">In [<span class="number">30</span>]: <span class="keyword">for</span> name,group <span class="keyword">in</span> df.groupby(len):</span><br><span class="line">    ...:     print(name,group)</span><br><span class="line">    ...:</span><br><span class="line"><span class="number">3</span>     key1 key2     data1     data2</span><br><span class="line">Joe    a  one <span class="number">-1.066519</span> <span class="number">-0.329629</span></span><br><span class="line">Bob    a  two <span class="number">-0.753174</span>  <span class="number">1.384481</span></span><br><span class="line"><span class="number">4</span>      key1 key2    data1     data2</span><br><span class="line">Jack    b  two  <span class="number">0.23007</span>  <span class="number">0.232354</span></span><br><span class="line"><span class="number">5</span>       key1 key2     data1     data2</span><br><span class="line">Alice    b  one  <span class="number">2.126111</span> <span class="number">-0.563764</span></span><br><span class="line">Frack    a  one  <span class="number">0.835789</span> <span class="number">-0.289843</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>2）数据聚合Aggregation</p>
<p><strong>agg、aggregate方法使用聚合函数</strong></p>
<p>优化函数</p>
<ul>
<li>count</li>
<li>size</li>
<li>first、last、nth</li>
<li>std、var</li>
</ul>
<p>接收namedtuple，使用自定义函数名称</p>
<ul>
<li>(name,function)，name将作为列名</li>
<li>NameAgg：pd.NamedAgg(column=’xxx’,aggcfunc=’xxx’)</li>
<li>通过传入一个映射字典将不同聚合函数应用到不同列</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">36</span>]: df.groupby(<span class="string">&#x27;key1&#x27;</span>).agg(<span class="string">&#x27;describe&#x27;</span>)</span><br><span class="line">Out[<span class="number">36</span>]:</span><br><span class="line">     data1                                ...     data2</span><br><span class="line">     count      mean       std       min  ...       <span class="number">25</span>%       <span class="number">50</span>%       <span class="number">75</span>%       max</span><br><span class="line">key1                                      ...</span><br><span class="line">a      <span class="number">3.0</span> <span class="number">-0.327968</span>  <span class="number">1.019948</span> <span class="number">-1.066519</span>  ... <span class="number">-0.309736</span> <span class="number">-0.289843</span>  <span class="number">0.547319</span>  <span class="number">1.384481</span></span><br><span class="line">b      <span class="number">2.0</span>  <span class="number">1.178091</span>  <span class="number">1.340704</span>  <span class="number">0.230070</span>  ... <span class="number">-0.364734</span> <span class="number">-0.165705</span>  <span class="number">0.033325</span>  <span class="number">0.232354</span></span><br><span class="line"></span><br><span class="line">[<span class="number">2</span> rows x <span class="number">16</span> columns]</span><br><span class="line"><span class="comment">#NamedAgg</span></span><br><span class="line">In [<span class="number">45</span>]: df.groupby(<span class="string">&#x27;key1&#x27;</span>).agg(data1_max=pd.NamedAgg(column=<span class="string">&#x27;data1&#x27;</span>,aggfunc=<span class="string">&#x27;max&#x27;</span>))</span><br><span class="line">Out[<span class="number">45</span>]:</span><br><span class="line">      data1_max</span><br><span class="line">key1</span><br><span class="line">a      <span class="number">0.835789</span></span><br><span class="line">b      <span class="number">2.126111</span></span><br></pre></td></tr></table></figure>
<h3 id="时间序列"><a href="#时间序列" class="headerlink" title="时间序列"></a>时间序列</h3><p>1、时间与字符串</p>
<ul>
<li><p>strftime：对datetime对象和Timestamp对象进行格式化。</p>
</li>
<li><p>strptime：将字符串转换为日期。</p>
</li>
<li><p>dateutil.parser.parse：解析日期，传入dayfirst将日期置于月份前。</p>
</li>
<li>pd.to_datetime：转换成DatetimeIndex对象。</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">5</span>]: stamp = datetime.datetime(<span class="number">2020</span>,<span class="number">11</span>,<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">In [<span class="number">6</span>]: str(stamp)</span><br><span class="line">Out[<span class="number">6</span>]: <span class="string">&#x27;2020-11-01 00:00:00&#x27;</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">7</span>]: stamp.strftime(<span class="string">&#x27;%Y-%m-%d&#x27;</span>)</span><br><span class="line">Out[<span class="number">7</span>]: <span class="string">&#x27;2020-11-01&#x27;</span></span><br><span class="line"><span class="comment">#strptime</span></span><br><span class="line">In [<span class="number">12</span>]: value = <span class="string">&#x27;2020-11-01&#x27;</span></span><br><span class="line"></span><br><span class="line">IIn [<span class="number">13</span>]: datetime.strptime(value,<span class="string">&#x27;%Y-%m-%d&#x27;</span>)</span><br><span class="line">Out[<span class="number">13</span>]: datetime.datetime(<span class="number">2020</span>, <span class="number">11</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line"><span class="comment">#parser</span></span><br><span class="line"><span class="keyword">from</span> dateutil.parser <span class="keyword">import</span> parse</span><br><span class="line">In [<span class="number">15</span>]: parse(value)</span><br><span class="line">Out[<span class="number">15</span>]: datetime.datetime(<span class="number">2020</span>, <span class="number">11</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<p>2、生成日期范围、偏置</p>
<p><code>date_range(start=None, end=None, periods=None, freq=&#39;D&#39;, tz=None, normalize=False, name=None, closed=None, **kwargs)</code></p>
<ul>
<li>periods：生成时间戳的数量。</li>
<li>freq：时间序列频率。</li>
<li>normalize：生成标准化为零的时间戳。</li>
<li>tz：时区</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">19</span>]: pd.date_range(<span class="string">&#x27;2012-05-02 12:22:22&#x27;</span>,periods=<span class="number">5</span>,normalize=<span class="literal">True</span>)</span><br><span class="line">Out[<span class="number">19</span>]:</span><br><span class="line">DatetimeIndex([<span class="string">&#x27;2012-05-02&#x27;</span>, <span class="string">&#x27;2012-05-03&#x27;</span>, <span class="string">&#x27;2012-05-04&#x27;</span>, <span class="string">&#x27;2012-05-05&#x27;</span>,</span><br><span class="line">               <span class="string">&#x27;2012-05-06&#x27;</span>],</span><br><span class="line">              dtype=<span class="string">&#x27;datetime64[ns]&#x27;</span>, freq=<span class="string">&#x27;D&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>基础频率：pandas.tseries.offsets import Hour,Minute,Second</p>
<p>频率freq：’WOM-3FRI’ 每月第三个星期五</p>
<p>移位shift：将Series、DataFrame数据进行移位而不影响索引，正数表示向下移位。还可以传入时间频率freq，表示移动时间戳而不改变数据。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">26</span>]: ts</span><br><span class="line">Out[<span class="number">26</span>]:</span><br><span class="line"><span class="number">2012</span><span class="number">-05</span><span class="number">-02</span>    <span class="number">0.687834</span></span><br><span class="line"><span class="number">2012</span><span class="number">-05</span><span class="number">-03</span>   <span class="number">-1.804440</span></span><br><span class="line"><span class="number">2012</span><span class="number">-05</span><span class="number">-04</span>    <span class="number">1.186259</span></span><br><span class="line"><span class="number">2012</span><span class="number">-05</span><span class="number">-05</span>   <span class="number">-2.511985</span></span><br><span class="line"><span class="number">2012</span><span class="number">-05</span><span class="number">-06</span>    <span class="number">0.887442</span></span><br><span class="line">Freq: D, dtype: float64</span><br><span class="line"><span class="comment">#shift</span></span><br><span class="line">In [<span class="number">28</span>]: ts.shift(<span class="number">-2</span>)</span><br><span class="line">Out[<span class="number">28</span>]:</span><br><span class="line"><span class="number">2012</span><span class="number">-05</span><span class="number">-02</span>    <span class="number">1.186259</span></span><br><span class="line"><span class="number">2012</span><span class="number">-05</span><span class="number">-03</span>   <span class="number">-2.511985</span></span><br><span class="line"><span class="number">2012</span><span class="number">-05</span><span class="number">-04</span>    <span class="number">0.887442</span></span><br><span class="line"><span class="number">2012</span><span class="number">-05</span><span class="number">-05</span>         NaN</span><br><span class="line"><span class="number">2012</span><span class="number">-05</span><span class="number">-06</span>         NaN</span><br><span class="line">Freq: D, dtype: float64</span><br><span class="line"><span class="comment">#freq</span></span><br><span class="line">In [<span class="number">29</span>]: ts.shift(<span class="number">-2</span>,freq=<span class="string">&#x27;D&#x27;</span>)</span><br><span class="line">Out[<span class="number">29</span>]:</span><br><span class="line"><span class="number">2012</span><span class="number">-04</span><span class="number">-30</span>    <span class="number">0.687834</span></span><br><span class="line"><span class="number">2012</span><span class="number">-05</span><span class="number">-01</span>   <span class="number">-1.804440</span></span><br><span class="line"><span class="number">2012</span><span class="number">-05</span><span class="number">-02</span>    <span class="number">1.186259</span></span><br><span class="line"><span class="number">2012</span><span class="number">-05</span><span class="number">-03</span>   <span class="number">-2.511985</span></span><br><span class="line"><span class="number">2012</span><span class="number">-05</span><span class="number">-04</span>    <span class="number">0.887442</span></span><br></pre></td></tr></table></figure>
<p>3、时区处理</p>
<p>pytz库</p>
<ul>
<li><p>国际标准时间UTC</p>
</li>
<li><p>common_timezones：常用时区</p>
</li>
<li><p>pytz.timezone(‘Asia/Shanghai’)：创建一个时区对象。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">tz = pytz.timezone(<span class="string">&#x27;Asia/Shanghai&#x27;</span>)</span><br><span class="line">In [<span class="number">46</span>]: tz</span><br><span class="line">Out[<span class="number">46</span>]: &lt;DstTzInfo <span class="string">&#x27;Asia/Shanghai&#x27;</span> LMT+<span class="number">8</span>:<span class="number">06</span>:<span class="number">00</span> STD&gt;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>时区转换</p>
<ul>
<li><p>tz_localize(‘xxx’)：从简单时区转换到本地化时区</p>
</li>
<li><p>tz_convert(‘xxx’)：转换时区</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#tz_localize</span></span><br><span class="line">In [<span class="number">51</span>]: ts_utc = ts.tz_localize(<span class="string">&#x27;UTC&#x27;</span>)</span><br><span class="line">In [<span class="number">52</span>]: ts_utc.index</span><br><span class="line">Out[<span class="number">52</span>]:</span><br><span class="line">DatetimeIndex([<span class="string">&#x27;2012-05-02 00:00:00+00:00&#x27;</span>, <span class="string">&#x27;2012-05-03 00:00:00+00:00&#x27;</span>,</span><br><span class="line">               <span class="string">&#x27;2012-05-04 00:00:00+00:00&#x27;</span>, <span class="string">&#x27;2012-05-05 00:00:00+00:00&#x27;</span>,</span><br><span class="line">               <span class="string">&#x27;2012-05-06 00:00:00+00:00&#x27;</span>],</span><br><span class="line">              dtype=<span class="string">&#x27;datetime64[ns, UTC]&#x27;</span>, freq=<span class="string">&#x27;D&#x27;</span>)</span><br><span class="line"><span class="comment">#tz_convert</span></span><br><span class="line">In [<span class="number">55</span>]: ts_utc.tz_convert(<span class="string">&#x27;Asia/Shanghai&#x27;</span>).index</span><br><span class="line">Out[<span class="number">55</span>]:</span><br><span class="line">DatetimeIndex([<span class="string">&#x27;2012-05-02 08:00:00+08:00&#x27;</span>, <span class="string">&#x27;2012-05-03 08:00:00+08:00&#x27;</span>,</span><br><span class="line">               <span class="string">&#x27;2012-05-04 08:00:00+08:00&#x27;</span>, <span class="string">&#x27;2012-05-05 08:00:00+08:00&#x27;</span>,</span><br><span class="line">               <span class="string">&#x27;2012-05-06 08:00:00+08:00&#x27;</span>],</span><br><span class="line">              dtype=<span class="string">&#x27;datetime64[ns, Asia/Shanghai]&#x27;</span>, freq=<span class="string">&#x27;D&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>时区操作</p>
<ul>
<li>不同时区的事件序列进行联合时结果将是UTC时间。</li>
</ul>
<p>4、频率转换</p>
<ul>
<li><p>生成日期得到PeriodIndex对象 ：<code>Period(value=None, freq=None, ordinal=None, year=None, month=None, quarter=None, day=None, hour=None, minute=None, second=None)</code></p>
</li>
<li><p>区间频率转换</p>
<ul>
<li><p><code>asfreq（freq，method = None，how = &#39;end&#39;，normalize = False，fill_value = None）</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">70</span>]: df</span><br><span class="line">Out[<span class="number">70</span>]:</span><br><span class="line">                       s</span><br><span class="line"><span class="number">2000</span><span class="number">-01</span><span class="number">-01</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>  <span class="number">0.0</span></span><br><span class="line"><span class="number">2000</span><span class="number">-01</span><span class="number">-01</span> <span class="number">00</span>:<span class="number">01</span>:<span class="number">00</span>  NaN</span><br><span class="line"><span class="number">2000</span><span class="number">-01</span><span class="number">-01</span> <span class="number">00</span>:<span class="number">02</span>:<span class="number">00</span>  <span class="number">2.0</span></span><br><span class="line"><span class="number">2000</span><span class="number">-01</span><span class="number">-01</span> <span class="number">00</span>:<span class="number">03</span>:<span class="number">00</span>  <span class="number">3.0</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">71</span>]: df.asfreq(freq=<span class="string">&#x27;30S&#x27;</span>,fill_value=<span class="number">9.0</span>)</span><br><span class="line">Out[<span class="number">71</span>]:</span><br><span class="line">                       s</span><br><span class="line"><span class="number">2000</span><span class="number">-01</span><span class="number">-01</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>  <span class="number">0.0</span></span><br><span class="line"><span class="number">2000</span><span class="number">-01</span><span class="number">-01</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">30</span>  <span class="number">9.0</span></span><br><span class="line"><span class="number">2000</span><span class="number">-01</span><span class="number">-01</span> <span class="number">00</span>:<span class="number">01</span>:<span class="number">00</span>  NaN</span><br><span class="line"><span class="number">2000</span><span class="number">-01</span><span class="number">-01</span> <span class="number">00</span>:<span class="number">01</span>:<span class="number">30</span>  <span class="number">9.0</span></span><br><span class="line"><span class="number">2000</span><span class="number">-01</span><span class="number">-01</span> <span class="number">00</span>:<span class="number">02</span>:<span class="number">00</span>  <span class="number">2.0</span></span><br><span class="line"><span class="number">2000</span><span class="number">-01</span><span class="number">-01</span> <span class="number">00</span>:<span class="number">02</span>:<span class="number">30</span>  <span class="number">9.0</span></span><br><span class="line"><span class="number">2000</span><span class="number">-01</span><span class="number">-01</span> <span class="number">00</span>:<span class="number">03</span>:<span class="number">00</span>  <span class="number">3.0</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<p>5、重采样</p>
<p><code>resample(rule, axis=0, closed=None, label=None, convention=&#39;start&#39;, kind=None, loffset=None, base=None, on=None, level=None, origin=&#39;start_day&#39;, offset=None)</code></p>
<ul>
<li>频率转换和时间序列重采样的便捷方法。对象必须具有类似datetime的索引，或将类似datetime的值传递给on或level关键字。</li>
<li></li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>





  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/7/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><span class="page-number current">8</span><a class="page-number" href="/page/9/">9</a><span class="space">&hellip;</span><a class="page-number" href="/page/20/">20</a><a class="extend next" rel="next" href="/page/9/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



      

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      const activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      const commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

    </div>
  </main>

  <footer class="footer">
    <div class="footer-inner">
      

      

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">ggl</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/mist/" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <script src="//cdn.jsdelivr.net/npm/animejs@3.2.0/lib/anime.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  


















  








  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    // window.MathJax = {
    //   loader: {
    //
    //     source: {
    //       '[tex]/amsCd': '[tex]/amscd',
    //       '[tex]/AMScd': '[tex]/amscd'
    //     }
    //   },
    //   tex: {
    //     inlineMath: {'[+]': [['$', '$']]},
    //
    //     tags: 'ams'
    //   },
    //   options: {
    //     renderActions: {
    //       findScript: [10, doc => {
    //         document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
    //           const display = !!node.type.match(/; *mode=display/);
    //           const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
    //           const text = document.createTextNode('');
    //           node.parentNode.replaceChild(text, node);
    //           math.start = {node: text, delim: '', n: 0};
    //           math.end = {node: text, delim: '', n: 0};
    //           doc.math.push(math);
    //         });
    //       }, '', false],
    //       insertedScript: [200, () => {
    //         document.querySelectorAll('mjx-container').forEach(node => {
    //           let target = node.parentNode;
    //           if (target.nodeName.toLowerCase() === 'li') {
    //             target.parentNode.classList.add('has-jax');
    //           }
    //         });
    //       }, '', false]
    //     }
    //   }
    // };
    window.MathJax = {
      tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        processEscapes: true
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = 'https://cdn.jsdelivr.net/npm/mathjax@2.7.8/unpacked/MathJax.js?config=TeX-MML-AM_CHTML';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  

</body>
</html>
